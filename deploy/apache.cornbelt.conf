<VirtualHost *:80>
    ServerName cornbelt.co.ke
    ServerAlias www.cornbelt.co.ke

    DocumentRoot /var/www/cornbelt
    <Directory /var/www/cornbelt>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    # SPA rewrite: serve index.html for non-file requests
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]
    RewriteRule ^ /index.html [L]

    # Route api.php explicitly to PHP-FPM via ProxyPassMatch or SetHandler depending on setup
    # If using php-fpm via proxy (example):
    <FilesMatch "^api.php$">
        SetHandler "proxy:unix:/run/php/php-fpm.sock|fcgi://localhost/"
    </FilesMatch>

    # Optional: log files
    ErrorLog ${APACHE_LOG_DIR}/cornbelt_error.log
    CustomLog ${APACHE_LOG_DIR}/cornbelt_access.log combined

    # Caching for static assets
    <IfModule mod_expires.c>
        ExpiresActive On
        ExpiresByType text/css "access plus 30 days"
        ExpiresByType application/javascript "access plus 30 days"
        ExpiresByType image/* "access plus 30 days"
    </IfModule>

</VirtualHost>
